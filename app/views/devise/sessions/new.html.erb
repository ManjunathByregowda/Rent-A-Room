<div class="container">
  <div class="col-md-4">
    <h2>Log in</h2>

    <%= form_for(resource, as: resource_name, url: session_path(resource_name)) do |f| %>
      <div class="form-group">
        <%= f.label :username %><br />
        <%= f.text_field :username, autofocus: true, class: "form-control" %>
        <span id="username"></span>
      </div>

      <div class="form-group">
        <%= f.label :password %>(<a href="#" id="show">Show</a>)<br />
        <%= f.password_field :password, autocomplete: "off", class: "form-control" %>
        <span id="password"></span>
      </div>

      <% if devise_mapping.rememberable? -%>
        <div class="form-group">
          <%= f.check_box :remember_me %>
          <%= f.label :remember_me %>
        </div>
      <% end -%>

      <div class="actions">
        <%= f.submit "Log in", class: "btn btn-primary" %>
      </div>
    <% end %>

    <%= render "devise/shared/links" %>
  </div>
</div>

<script>

  errors = {
    name: false,
    password: false
  };

  var userNameHandle = document.getElementById('user_username');
  var passwordHandle = document.getElementById('user_password');
  var registerForm = document.getElementById('new_user');

  var userNameMsgHandle = document.getElementById('username');
  var passwordMsgHandle = document.getElementById('password');


  var showHandle = document.querySelector('#show');
  var showToggle = true;

  showHandle.addEventListener('click',function(e){
    if(showToggle){
      passwordHandle.setAttribute('type','text');
      showHandle.innerHTML = 'Hide';
      showToggle = false;
    }else{
      passwordHandle.setAttribute('type','password'); 
      showHandle.innerHTML = 'Show';
      showToggle = true;
    }
    e.preventDefault();
  },false)


  var userNameFormatter = /^[a-zA-Z ]*$/;
  var passwordFormatter =  /^[a-zA-Z0-9!@#$%^&*]{6,16}$/;

  function validateName(){
    if(userNameHandle.value ==""){
        userNameMsgHandle.innerHTML = "email is required";
        errors.name = false;
    }else if(!userNameFormatter.test(userNameHandle.value)){
        userNameMsgHandle.innerHTML = "Should contain only alphabets";
        errors.name = false;
    }else{
        userNameMsgHandle.innerHTML = "";
        errors.name = true;
    }
  }

  function validatePassword(){
    if(passwordHandle.value == ""){
        passwordMsgHandle.innerHTML = "password is required";
        errors.password = false;
    }else if(passwordHandle.value.length < 6){
        passwordMsgHandle.innerHTML = "password Should be more than 6 character";
        errors.password = false;
    }else if(!passwordFormatter.test(passwordHandle.value)){
        passwordMsgHandle.innerHTML = "password is invaild"
        errors.password = false;
    }else{
        passwordMsgHandle.innerHTML = "";
        errors.password = true;
    }
  }

  registerForm.addEventListener('submit',function(e){
    validateName();
    validatePassword();

    if(Object.values(errors).includes(false)){
      e.preventDefault();

      }
  },false);

</script>
